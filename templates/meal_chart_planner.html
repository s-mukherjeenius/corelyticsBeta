{% extends "base.html" %}

{% block title %}Meal Planner - Corelytics{% endblock title %}

{% block page_title %}Meal Planner{% endblock page_title %}

{% block head_extra %}
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/meal_plan.css') }}">
{% endblock head_extra %}

{% block content %}
<div class="text-center py-5 bg-white p-6 rounded-3xl shadow-md"> 
    <p class="lead text-gray-600 mb-5">Generate a personalized 7-day meal plan based on your profile goals.</p>
    
    <button id="generatePlanBtn" class="btn btn-primary btn-lg">
        <span id="btnText">Generate My Meal Plan</span>
        <span id="btnSpinner" class="spinner-border spinner-border-sm" role="status" aria-hidden="true" style="display: none;"></span>
    </button>
    
    <div id="loadingSpinner" class="loading-spinner" style="display: none;">
        <p class="mt-2 text-gray-700">Generating your personalized meal plan... (This may take a moment)</p>
    </div>

    <div id="errorMessage" class="error-message" style="display: none;"></div>
</div>

<div id="mealPlanDisplay" class="card shadow-lg mt-5 bg-white rounded-xl p-4 p-md-5" style="display: none;">
    <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-3">
        <h2 class="text-2xl font-bold text-gray-800 m-0">Your 7-Day Meal Plan</h2>
        <button id="downloadPdfBtn" class="btn btn-outline-danger btn-sm">
            <i class="fas fa-file-pdf me-2"></i>Download PDF
        </button>
    </div>
    <hr class="mb-4">
    
    <div id="mealPlanText" class="meal-plan-content"></div> 
</div>
{% endblock content %}

{% block scripts_extra %}
<script src="{{ url_for('static', filename='js/meal_planner.js') }}"></script>
{% endblock scripts_extra %}